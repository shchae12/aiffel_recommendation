# aiffel_recommendation
λ¨λ‘μ μ—°κµ¬μ† λ°μ΄ν„° μ‚¬μ΄μ–Έν‹°μ¤νΈ 'λ”¥λ¬λ‹ κΈ°λ° μ¶”μ² μ‹μ¤ν…' ν”„λ΅μ νΈ μ μ¶ λ ν¬μ§€ν† λ¦¬μ…λ‹λ‹¤.  

## ν΄λ” κµ¬μ΅°
```
π“ aiffel_recommendation/  
β”‚
β”β”€β”€ π“ autoint/                                   # autoint λ¨λΈ ν…μ¤νΈ & λ°°ν¬   
β”‚   β””β”€β”€ π“ __pycache__/                           # νμ΄μ¬ μΊμ‹ νμΌ_λ¬΄μ‹  
|   β””β”€β”€ π“ data/  
β”‚       β”β”€β”€ π“ ml-1m                              # κ° λ°μ΄ν„°λ³„ 1μ°¨ μ „μ²λ¦¬ csv νμΌ  
β”‚       β”β”€β”€ π“„ autoIntMLP_field_dims.npy          # + λ¨λΈ μ μ© field_dims  
β”‚       β”β”€β”€ π“„ autoIntMLP_label_encodes.pkl       # + λ¨λΈ μ μ© label_encoder  
β”‚       β”β”€β”€ π“„ field_dims.npy  
β”‚       β”β”€β”€ π“„ movielens_rcmm_v1.csv              # λλ¤ μƒν”λ§ κΈ°λ° μ „μ²λ¦¬ λ°μ΄ν„°  
β”‚       β””β”€β”€ π“„ movielens_rcmm_v2.csv              # μ‹¤μ  μ μ©λ μ‚¬μ©μ μ„ νΈλ„ κΈ°λ° μ „μ²λ¦¬  
β”‚  
|   β””β”€β”€ π“ model/  
β”‚       β”β”€β”€ π“„ autoIntMLP_model_weights.h5        # AutoInt+ λ¨λΈ κ°€μ¤‘μΉ   
β”‚       β””β”€β”€ π“„ autoInt_model_weights.h5  
β”‚  
|   β””β”€β”€ π“„ autoint.py  
|   β””β”€β”€ π“„ autointplus.py                         # AutoInt+ λ¨λΈ μ •μ   
|   β””β”€β”€ π“„ model_load_test.ipynb  
|   β””β”€β”€ π“„ plus_model_train.ipynb                 # AutoInt+ λ¨λΈ μ„±λ¥ ν…μ¤νΈ λ…ΈνΈλ¶  
|   β””β”€β”€ π“„ show_st.py  
|   β””β”€β”€ π“„ show_st_plus.py                        # AutoInt+ λ¨λΈ streamlit λ°°ν¬ νμΌ  
β”‚  
β”β”€β”€ π“„ 0711_9.λ‚λ§μ λ”¥λ¬λ‹ κΈ°λ° μ¶”μ² μ‹μ¤ν… κµ¬μ¶•ν•κΈ°.ipynb # EDA & AutoInt λ¨λΈ κµ¬ν„                 
β”‚  
β”β”€β”€ π“„ requirements.txt            # Python ν¨ν‚¤μ§€  
β”‚  
β””β”€β”€ π“„ README.md  
```
  
## μ‹¤ν— λ‚΄μ©
AutoInt+ λ¨λΈμ μ„±λ¥μ„ κ°μ„ ν•κ³ μ λ‹¤μ–‘ν• ν•μ΄νΌνλΌλ―Έν„°λ¥Ό μ΅°ν•©ν•μ—¬ μ‹¤ν—μ„ μ§„ν–‰ν•μ€λ‹¤.  
μ‹¤ν—μ€ autoint/plus_model_train.ipynb νμΌμ—μ„ μν–‰λμ—μΌλ©°, μ‹¤ν— κ²°κ³Ό λ² μ¤νΈ λ¨λΈμ„ μ„ μ •ν•μ—¬ StreamlitμΌλ΅ λ°°ν¬ν•μ€λ‹¤.  
  
### μ‹¤ν— μ„¤μ •
λ‹¤μκ³Ό κ°™μ€ ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©μ„ λ€μƒμΌλ΅ μ‹¤ν—μ„ μ§„ν–‰:
- epochs: 3 λλ” 5
- learning_rate: 0.0001 / 0.0005 / 0.001
- dropout: 0.3 ~ 0.7
- batch_size: 1024 λλ” 2048
- embed_dim: 16 λλ” 32
- att_head_num: 2 / 4 / 8 β† κΈ°λ³Έ μ–΄ν…μ… ν—¤λ“ μλ” 2κ°μ΄λ‚ μ¶”κ°€λ΅ μ„¤μ •ν•μ—¬ ν…μ¤νΈ ν•΄λ³΄κΈ° μ„ν•¨μΌλ΅ μ¶”κ°€  
  
![model-parameter](https://github.com/user-attachments/assets/da34c7b1-3fbe-495c-95d7-efc4caa3f06d)
  
### μ‹¤ν— κ²°κ³Ό μ”μ•½
![model-test-result](https://github.com/user-attachments/assets/6f1f357d-6d14-4544-8150-b781a2e49c46)  
  
### μ‹¤ν— κ²°κ³Ό λ¶„μ„
- **μ–΄ν…μ… ν—¤λ“ μ(att_head_num)** λ” 2, 4, 8λ΅ μ„¤μ •ν•΄κ°€λ©° λΉ„κµν–μΌλ©°, μΌλ¶€ μ‹¤ν—μ—μ„λ” μ„±λ¥μ΄ ν–¥μƒλμ—μΌλ‚  
Exp 1, 2, 3μ„ ν™•μΈν•λ©΄ λ™μΌν• μ΅°κ±΄μ—μ„ ν—¤λ“ μλ¥Ό λλ¦°λ‹¤κ³  ν•΄μ„ λ¨λΈμ μ„±λ¥μ΄ κΌ­ λ†’μ•„μ§€λ” κ²ƒμ€ μ•„λ‹μ—λ‹¤. 

- μ„±λ¥μ΄ κ°€μ¥ μΆ‹μ•λ Exp_5 λ¨λΈμ μ΅°κ±΄μ„ λ°”νƒ•μΌλ΅,
embed_dimμ„ 32λ΅ λ†’μ—¬ μ¶”κ°€ μ‹¤ν—(Exp_6)λ„ μ§„ν–‰ν•΄λ³΄μ•λ”λ‹ μ„±λ¥μ΄ λ―Έμ•½ν•μ§€λ§ ν–¥μƒλμ–΄ best_modelμ΄ λμ—λ‹¤. 

- μ „μ²΄μ μΌλ΅ ν•™μµλ¥  0.001, λ“λ΅­μ•„μ›ƒ 0.5, λ°°μΉ μ‚¬μ΄μ¦ 1024μ—μ„ μ•μ •μ μ΄κ³  μΆ‹μ€ μ„±λ¥μ„ λ³΄μ€λ‹¤.
- ν—¤λ“ μκ°€ λ§μ„μλ΅ ν•™μµ μ‹κ°„μ΄ μ¤λ κ±Έλ¦°λ‹¤. 
  
## Streamlit
https://aiffelrecommendation-movielens.streamlit.app/  
(* Streamlit Cloudμ λ©”λ¨λ¦¬ λ¬Έμ λ΅ μΈν•μ—¬ νμ΄μ§€κ°€ κ³„μ† μ£½λ” λ¬Έμ κ°€ λ°μƒν•λ‹¤..)  
  
**λ΅μ»¬ ν™κ²½ ν…μ¤νΈ**  
  
![local-streamlit](https://github.com/user-attachments/assets/2073627f-4c54-409b-b797-04d5b023cea9)  
